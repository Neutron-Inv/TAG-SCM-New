<?php set_time_limit(9000); ?>
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="x-apple-disable-message-reformatting">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

        <style type="text/css">
            a { text-decoration: none; outline: none; }
            @media (max-width: 649px) {
                .o_col-full { max-width: 100% !important; }
                .o_col-half { max-width: 50% !important; }
                .o_hide-lg { display: inline-block !important; font-size: inherit !important; max-height: none !important; line-height: inherit !important; overflow: visible !important; width: auto !important; visibility: visible !important; }
                .o_hide-xs, .o_hide-xs.o_col_i { display: none !important; font-size: 0 !important; max-height: 0 !important; width: 0 !important; line-height: 0 !important; overflow: hidden !important; visibility: hidden !important; height: 0 !important; }
                .o_xs-center { text-align: center !important; }
                .o_xs-left { text-align: left !important; }
                .o_xs-right { text-align: left !important; }
                table.o_xs-left { margin-left: 0 !important; margin-right: auto !important; float: none !important; }
                table.o_xs-right { margin-left: auto !important; margin-right: 0 !important; float: none !important; }
                table.o_xs-center { margin-left: auto !important; margin-right: auto !important; float: none !important; }
                h1.o_heading { font-size: 32px !important; line-height: 41px !important; }
                h2.o_heading { font-size: 26px !important; line-height: 37px !important; }
                h3.o_heading { font-size: 20px !important; line-height: 30px !important; }
                .o_xs-py-md { padding-top: 24px !important; padding-bottom: 24px !important; }
                .o_xs-pt-xs { padding-top: 8px !important; }
                .o_xs-pb-xs { padding-bottom: 8px !important; }
            }
            @media screen {
                @font-face {
                  font-family: 'Roboto';
                  font-style: normal;
                  font-weight: 400;
                  src: local("Roboto"), local("Roboto-Regular"), url(https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu7GxKOzY.woff2) format("woff2");
                  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF; }
                @font-face {
                  font-family: 'Roboto';
                  font-style: normal;
                  font-weight: 400;
                  src: local("Roboto"), local("Roboto-Regular"), url(https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxK.woff2) format("woff2");
                  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD; }
                @font-face {
                  font-family: 'Roboto';
                  font-style: normal;
                  font-weight: 700;
                  src: local("Roboto Bold"), local("Roboto-Bold"), url(https://fonts.gstatic.com/s/roboto/v18/KFOlCnqEu92Fr1MmWUlfChc4EsA.woff2) format("woff2");
                  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF; }
                @font-face {
                  font-family: 'Roboto';
                  font-style: normal;
                  font-weight: 700;
                  src: local("Roboto Bold"), local("Roboto-Bold"), url(https://fonts.gstatic.com/s/roboto/v18/KFOlCnqEu92Fr1MmWUlfBBc4.woff2) format("woff2");
                  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD; }
                .o_sans, .o_heading { font-family: "Roboto", sans-serif !important; }
                .o_heading, strong, b { font-weight: 700 !important; }
                a[x-apple-data-detectors] { color: inherit !important; text-decoration: none !important; }
            }
              #canvas td.o_hide, #canvas td.o_hide div { display: block!important; font-family: "Roboto", sans-serif; font-size: 16px!important;
              color: #000; font-size: inherit!important; max-height: none!important; width: auto!important; line-height: inherit!important; visibility: visible!important;}
              .CodeMirror { line-height: 1.4; font-size: 12px; font-family: sans-serif; }
        </style>
    </head>

<body>
    <div class="container" style="background: white; color:black !important;">
        
<div class="row">
<p style="color: black !important;">Good Day Madam, <br/> I trust this mail meets you well. <br/> Please see below updated list of RFQs and POs received for your perusal. </p>

<style>
  .monthlytable th, .monthlytable td, .monthlytable thead {
    border: 1px solid #000;
  }

  .monthlytable th {
    white-space: nowrap;
    font-weight: bold;
    padding: 5px 13px !important;
  }

  .monthlytable{
    font-size:9.0pt !important;
  }

  .monthlytable thead {
    font-weight: bold;
  }

  .monthlytable tbody {
    color: black;
  }

  .monthlytable td {
    font-size:9.0pt !important;
    color:black !important;
    padding:3px;
    text-align:center;
  }
</style>

<div class="table-container">
                                
                                <div class="table table-bordered">
                            <h5 style="text-align:center; vertical-align:center; padding:1%;"><b> TAG Year  to Date List of RFQ's & PO's for <?php echo date('Y'); ?> </b></h5>
                                    <table cellspacing="0" cellpadding="1" width="100%" style="margin-left:-.15pt; border-collapse:collapse; background-color: #ffffff;" class="monthlytable table">
                                    <thead style="color:black;"> <!-- Top-level header -->
                                    <tr>
                                    <th colspan="1" style="text-align:center; background-color:white;"></th>
                                    <th colspan="2" style="text-align:center; background-color:#8ea9db; border: 1px solid #000; font-weight: bold;">NLNG</th>
                                    <th colspan="2" style="text-align:center; background-color:#f4b084; border: 1px solid #000; font-weight: bold;">TOTAL</th>
                                    <th colspan="2" style="text-align:center; background-color:#ffd966; border: 1px solid #000; font-weight: bold;">SHELL</th>
                                    <th colspan="2" style="text-align:center; background-color:#00b0f0; border: 1px solid #000; font-weight: bold;">SAIPEM</th>
                                    <th colspan="2" style="text-align:center; background-color:#a5a5a5; border: 1px solid #000; font-weight: bold;">DAEWOO</th>
                                    </tr>
                                    <tr>
                                    <th style="text-align:center; background-color:white; font-weight: bold;">PRODUCTS</th>
                                    <th style="text-align:center; background-color:#8ea9db; border: 1px solid #000; font-weight: bold;">RFQ RECEIVED</th>
                                    <th style="text-align:center; background-color:#8ea9db; border: 1px solid #000; font-weight: bold;">PO RECEIVED</th>
                                    <th style="text-align:center; background-color:#f4b084; border: 1px solid #000; font-weight: bold;">RFQ RECEIVED</th>
                                    <th style="text-align:center; background-color:#f4b084; border: 1px solid #000; font-weight: bold;">PO RECEIVED</th>
                                    <th style="text-align:center; background-color:#ffd966; border: 1px solid #000; font-weight: bold;">RFQ RECEIVED</th>
                                    <th style="text-align:center; background-color:#ffd966; border: 1px solid #000; font-weight: bold;">PO RECEIVED</th>
                                    <th style="text-align:center; background-color:#00b0f0; border: 1px solid #000; font-weight: bold;">RFQ RECEIVED</th>
                                    <th style="text-align:center; background-color:#00b0f0; border: 1px solid #000; font-weight: bold;">PO RECEIVED</th>
                                    <th style="text-align:center;background-color:#a5a5a5; border: 1px solid #000; font-weight: bold;">RFQ RECEIVED</th>
                                    <th style="text-align:center;background-color:#a5a5a5; border: 1px solid #000; font-weight: bold;">PO RECEIVED</th>
                                    </tr>

                                </thead>
                                        <tbody style="color:black;">
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left;padding: 3px 7px;">VALVES</td>
                                        <td>{{ count(getValveRfq('114')) ?? 0 }}</td>
                                        <td>{{ count(getValvePo('114')) ?? 0 }}</td>
                                        <td>{{ count(getValveRfq('148')) ?? 0 }}</td>
                                        <td>{{ count(getValvePo('148')) ?? 0 }}</td>
                                        <td>{{ count(getValveRfq('2')) ?? 0 }}</td>
                                        <td>{{ count(getValvePo('2')) ?? 0 }}</td>
                                        <td>{{ count(getValveRfq('266')) ?? 0 }}</td>
                                        <td>{{ count(getValvePo('266')) ?? 0 }}</td>
                                        <td>{{ count(getValveRfq('167')) ?? 0 }}</td>
                                        <td>{{ count(getValvePo('167')) ?? 0 }}</td>
                                        </tr>
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left;padding: 3px 7px;">GASKET</td>
                                        <td>{{ count(getGasketRfq('114')) ?? 0 }}</td>
                                        <td>{{ count(getGasketPo('114')) ?? 0 }}</td>
                                        <td>{{ count(getGasketRfq('148')) ?? 0 }}</td>
                                        <td>{{ count(getGasketPo('148')) ?? 0 }}</td>
                                        <td>{{ count(getGasketRfq('2')) ?? 0 }}</td>
                                        <td>{{ count(getGasketPo('2')) ?? 0 }}</td>
                                        <td>{{ count(getGasketRfq('266')) ?? 0 }}</td>
                                        <td>{{ count(getGasketPo('266')) ?? 0 }}</td>
                                        <td>{{ count(getGasketRfq('167')) ?? 0 }}</td>
                                        <td>{{ count(getGasketPo('167')) ?? 0 }}</td>
                                        </tr>
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left;padding: 3px 7px;">BOLTS & NUTS</td>
                                        <td>{{ count(getBoltAndNutRfq('114')) ?? 0 }}</td>
                                        <td>{{ count(getBoltAndNutPo('114')) ?? 0 }}</td>
                                        <td>{{ count(getBoltAndNutRfq('148')) ?? 0 }}</td>
                                        <td>{{ count(getBoltAndNutPo('148')) ?? 0 }}</td>
                                        <td>{{ count(getBoltAndNutRfq('2')) ?? 0 }}</td>
                                        <td>{{ count(getBoltAndNutPo('2')) ?? 0 }}</td>
                                        <td>{{ count(getBoltAndNutRfq('266')) ?? 0 }}</td>
                                        <td>{{ count(getBoltAndNutPo('266')) ?? 0 }}</td>
                                        <td>{{ count(getBoltAndNutRfq('167')) ?? 0 }}</td>
                                        <td>{{ count(getBoltAndNutPo('167')) ?? 0 }}</td>
                                        </tr>
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left; padding: 3px 7px;">FLANGES</td>
                                        <td>{{ count(getFlangesRfq('114')) ?? 0 }}</td>
                                        <td>{{ count(getFlangesPo('114')) ?? 0 }}</td>
                                        <td>{{ count(getFlangesRfq('148')) ?? 0 }}</td>
                                        <td>{{ count(getFlangesPo('148')) ?? 0 }}</td>
                                        <td>{{ count(getFlangesRfq('2')) ?? 0 }}</td>
                                        <td>{{ count(getFlangesPo('2')) ?? 0 }}</td>
                                        <td>{{ count(getFlangesRfq('266')) ?? 0 }}</td>
                                        <td>{{ count(getFlangesPo('266')) ?? 0 }}</td>
                                        <td>{{ count(getFlangesRfq('167')) ?? 0 }}</td>
                                        <td>{{ count(getFlangesPo('167')) ?? 0 }}</td>
                                        </tr>
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left;padding: 3px 7px;">PIPES & FITTINGS</td>
                                        <td>{{ count(getPipeRfq('114')) ?? 0 }}</td>
                                        <td>{{ count(getPipePo('114')) ?? 0 }}</td>
                                        <td>{{ count(getPipeRfq('148')) ?? 0 }}</td>
                                        <td>{{ count(getPipePo('148')) ?? 0 }}</td>
                                        <td>{{ count(getPipeRfq('2')) ?? 0 }}</td>
                                        <td>{{ count(getPipePo('2')) ?? 0 }}</td>
                                        <td>{{ count(getPipeRfq('266')) ?? 0 }}</td>
                                        <td>{{ count(getPipePo('266')) ?? 0 }}</td>
                                        <td>{{ count(getPipeRfq('167')) ?? 0 }}</td>
                                        <td>{{ count(getPipePo('167')) ?? 0 }}</td>
                                        </tr>
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left;padding: 3px 7px;">ROTORK ACTUATOR & GEARBOX</td>
                                        <td>{{ count(getRotorkRfq('114')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkPo('114')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkRfq('148')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkPo('148')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkRfq('2')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkPo('2')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkRfq('266')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkPo('266')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkRfq('167')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkPo('167')) ?? 0 }}</td>
                                        </tr>
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left;padding: 3px 7px;">OTHERS (REGULATOR, TUBE, SLABS, ETC)</td>
                                        <td>{{ count(getOtherRfq('114')) ?? 0 }}</td>
                                        <td>{{ count(getOtherPo('114')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkRfq('148')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkPo('148')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkRfq('2')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkPo('2')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkRfq('266')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkPo('266')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkRfq('167')) ?? 0 }}</td>
                                        <td>{{ count(getRotorkPo('167')) ?? 0 }}</td>
                                        </tr>
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left;padding: 3px 7px;">FLANGE MANAGEMENT SERVICES</td>
                                        <td>{{ count(getFMSRfq('114')) ?? 0 }}</td>
                                        <td>{{ count(getFMSPo('114')) ?? 0 }}</td>
                                        <td>{{ count(getFMSRfq('148')) ?? 0 }}</td>
                                        <td>{{ count(getFMSPo('148')) ?? 0 }}</td>
                                        <td>{{ count(getFMSRfq('2')) ?? 0 }}</td>
                                        <td>{{ count(getFMSPo('2')) ?? 0 }}</td>
                                        <td>{{ count(getFMSRfq('266')) ?? 0 }}</td>
                                        <td>{{ count(getFMSPo('266')) ?? 0 }}</td>
                                        <td>{{ count(getFMSRfq('167')) ?? 0 }}</td>
                                        <td>{{ count(getFMSPo('167')) ?? 0 }}</td>
                                        </tr>
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left;padding: 3px 7px;">TOTAL</td>
                                        <td>{{ count(getTotalRfq('114')) ?? 0 }}</td>
                                        <td>{{ count(getTotalPo('114')) ?? 0 }}</td>
                                        <td>{{ count(getTotalRfq('148')) ?? 0 }}</td>
                                        <td>{{ count(getTotalPo('148')) ?? 0 }}</td>
                                        <td>{{ count(getTotalRfq('2')) ?? 0 }}</td>
                                        <td>{{ count(getTotalPo('2')) ?? 0 }}</td>
                                        <td>{{ count(getFMSRfq('266')) ?? 0 }}</td>
                                        <td>{{ count(getFMSPo('266')) ?? 0 }}</td>
                                        <td>{{ count(getFMSRfq('167')) ?? 0 }}</td>
                                        <td>{{ count(getFMSPo('167')) ?? 0 }}</td>
                                        </tr>
                                        <tr style="color:black;">
                                        <td style="font-weight:bold;text-align:left;padding: 3px 7px;">PO Conversion Rate</td>
                                        <td colspan="2" style="text-align:center; font-weight:bold;">{{ (count(getTotalRfq('114')) > 0) ? (count(getTotalPo('114')) / count(getTotalRfq('114')) * 100) : 0 }}%</td>
                                        <td colspan="2" style="text-align:center; font-weight:bold;">{{ (count(getTotalRfq('148')) > 0) ? (count(getTotalPo('148')) / count(getTotalRfq('148')) * 100) : 0 }}%</td>
                                        <td colspan="2" style="text-align:center; font-weight:bold;">{{ (count(getTotalRfq('2')) > 0) ? (count(getTotalPo('2')) / count(getTotalRfq('2')) * 100) : 0 }}%</td>
                                        <td colspan="2" style="text-align:center; font-weight:bold;">{{ (count(getTotalRfq('266')) > 0) ? (count(getTotalPo('266')) / count(getTotalRfq('266')) * 100) : 0 }}%</td>
                                        <td colspan="2" style="text-align:center; font-weight:bold;">{{ (count(getTotalRfq('167')) > 0) ? (count(getTotalPo('167')) / count(getTotalRfq('167')) * 100) : 0 }}%</td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>

            <div class="col-md-12" style="margin-bottom: 40px;">
                <p style="font-size: 8.0pt;font-family: Arial,sans-serif; color: #1F497D;"> Best Regards,  <br/>
                    {{ Auth::user()->first_name . ' '. strtoupper(Auth::user()->last_name) }}, 
                    <br> Procurement Associate <br>
                    PHONE</span></b><span style="font-size:8.0pt; font-family:&quot;Arial&quot;,sans-serif; color:#1F3864; mso-fareast-language:ZH-CN">
                        : +234 1 342 8420&nbsp;| </span>
                        <span style="font-size:8.0pt; font-family:&quot;Arial&quot;,sans-serif; color:#1F4E79; mso-fareast-language:EN-GB">
                        +234 906 243 5410&nbsp; </span><span style="font-size:8.0pt; font-family:&quot;Arial&quot;,sans-serif; color:#1F3864; mso-fareast-language:ZH-CN">
                    </span><br><b><span style="font-size:8.0pt; font-family:&quot;Arial&quot;,sans-serif; color:#1F3864">EMAIL:
                    </span></b><span style="color:#2F5496"><a href="mailto:sales@tagenergygroup.net"><b><span style="font-size:8.0pt; font-family:&quot;Arial&quot;,sans-serif">
                        sales@tagenergygroup.net</span></b></a>
                    </span>

                </p>
                <img src="https://scm.enabledjobs.com/admin/img/signature.jpg" alt="SCM" style="width: 100%;">
            </div>
        </div>
    </div>
   
</body>
</html>
